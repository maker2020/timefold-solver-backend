<?xml version="1.0" encoding="UTF-8"?>
<solver xmlns="https://www.optaplanner.org/xsd/solver" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="https://www.optaplanner.org/xsd/solver https://www.optaplanner.org/xsd/solver/solver.xsd">
  <!-- To slowly prove there are no bugs in this code -->
  <!--<environmentMode>FULL_ASSERT</environmentMode>-->
  <!-- To solve faster by saturating multiple CPU cores -->
  <!--<moveThreadCount>AUTO</moveThreadCount>-->

  <solutionClass>cn.keyvalues.optaplanner.solution.cflp.domain.FacilityLocationSolution</solutionClass>
  <entityClass>cn.keyvalues.optaplanner.solution.cflp.domain.ServerStation</entityClass>
  <entityClass>cn.keyvalues.optaplanner.solution.cflp.domain.Customer</entityClass>
  <entityClass>cn.keyvalues.optaplanner.solution.cflp.domain.Assign</entityClass>

  <scoreDirectorFactory>
    <constraintProviderClass>cn.keyvalues.optaplanner.solution.cflp.solver.FacilityLocationConstraint</constraintProviderClass>
    <initializingScoreTrend>ONLY_DOWN</initializingScoreTrend>
  </scoreDirectorFactory>

  <termination>
    <!-- <minutesSpentLimit>5</minutesSpentLimit> -->
    <secondsSpentLimit>10</secondsSpentLimit>
  </termination>

  <constructionHeuristic>
    <!-- <constructionHeuristicType>FIRST_FIT_DECREASING</constructionHeuristicType> -->
    <constructionHeuristicType>FIRST_FIT</constructionHeuristicType>
  </constructionHeuristic>

  <localSearch>
    <unionMoveSelector>
      <changeMoveSelector>
        <valueSelector variableName="customer"/>
      </changeMoveSelector>
      <changeMoveSelector>
        <valueSelector variableName="station"/>
      </changeMoveSelector>
      <changeMoveSelector>
        <valueSelector variableName="assignedDemand"/>
      </changeMoveSelector>

      <swapMoveSelector>
        <entitySelector>
          <entityClass>cn.keyvalues.optaplanner.solution.cflp.domain.Assign</entityClass>
        </entitySelector>
        <!-- <secondaryEntitySelector>
          <entityClass>cn.keyvalues.optaplanner.solution.cflp.domain.Assign</entityClass>
        </secondaryEntitySelector> -->
        <variableNameIncludes>
          <variableNameInclude>customer</variableNameInclude>
          <variableNameInclude>station</variableNameInclude>
          <variableNameInclude>assignedDemand</variableNameInclude>
        </variableNameIncludes>
      </swapMoveSelector>
    </unionMoveSelector>

    <acceptor>
      <simulatedAnnealingStartingTemperature>100hard/100medium/0soft</simulatedAnnealingStartingTemperature>
    </acceptor>
  </localSearch>

  <!-- <acceptor>
    <lateAcceptanceSize>200</lateAcceptanceSize>
  </acceptor> -->

  <!-- <forager>
    <acceptedCountLimit>1</acceptedCountLimit>
  </forager> -->
  
</solver>
